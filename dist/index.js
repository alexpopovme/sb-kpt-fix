/*
  sb-kpt-fix v1.2.0
  Fixes PTP bug of incorrect organizing custom items in the Sidebar plugin or categories in the Top Menu plugin.
  Copyright (c) 2021-present Alexander Popov
*/
!function(){"use strict";let e="",t="";const l={sb:{re:/<group[\s\S]*?id=("customItem\d*")[\s\S]*?("alpo_sidebar_fullitemName\d*)[\s\S]*?(alpo_sidebar_fullsubItemIndex\d*)[\s\S]*?(alpo_sidebar_fullsubPanoIDs\d*)[\s\S]*?<\/group/g,fn:(t,l)=>{const a=t.replace(/alpo_sidebar_fullitemName\d*/,`alpo_sidebar_fullitemName${l}`).replace(/alpo_sidebar_fullsubItemIndex\d*/,`alpo_sidebar_fullsubItemIndex${l}`).replace(/alpo_sidebar_fullsubPanoIDs\d*/,`alpo_sidebar_fullsubPanoIDs${l}`);e=e.replace(t,a)}},tm:{re:/<group[\s\S]*?id=("catProps\d*")[\s\S]*?("alpo_topmenucatTitle\d*)[\s\S]*?(alpo_topmenusubPanoIDs\d*)[\s\S]*?<\/group/g,fn:(t,l)=>{const a=t.replace(/alpo_topmenucatTitle\d*/,`alpo_topmenucatTitle${l}`).replace(/alpo_topmenusubPanoIDs\d*/,`alpo_topmenusubPanoIDs${l}`);e=e.replace(t,a)}}};const a=(a,o)=>{e=a;const s=l[t].re,n=e.matchAll(s);Array.from(n,(e=>e[0])).map(l[t].fn),((e,t)=>{const l=new Blob([e],{type:"text/xml"}),a=window.URL.createObjectURL(l),o=document.createElement("a");o.style.display="none",o.href=a,o.download=`${t.slice(0,-4)}_edit.kpt`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(a)})(e,o)};window.onload=function(){(()=>{const e=document.querySelector('select[name="select"]');t=e.options[e.selectedIndex].value,e.addEventListener("change",(e=>{t=e.target.value}))})(),(()=>{const e=document.getElementById("kpt");e.addEventListener("change",(t=>{const l=e.files[0],o=new FileReader;o.onload=e=>a(o.result,l.name),o.readAsText(l)}))})()}}();
